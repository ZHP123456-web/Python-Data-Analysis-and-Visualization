"""
小案例3:
电商用户行为分析
场景：某电商平台的用户行为数据如下，请完成以下任务：
1.计算每位用户的总消费金额（消费金额=商品单价×购买数量）
2.找出消费额最高的用户，并输出其所有信息
3.计算所有用户的平均消费金额（保留2位小数）
4.统计电子产品的总购买数量
"""
import pandas as pd

data = {
    '用户ID':[101,102,103,104,105],
    '用户名':['Alice','Bob','Charlie','David','Eve'],
    '商品类别':['电子产品','服饰','电子产品','家居','服饰'],
    '商品单价':[1200,300,800,150,200],
    '购买数量':[1,3,2,5,4]
}
df = pd.DataFrame(data)

df['消费金额'] = df['商品单价'] * df['购买数量']
print(df)

print('消费额最高的用户:\n',df.nlargest(1,columns='消费金额'))

avg = df['消费金额'].mean()
print('用户的平均消费金额:%.2f'%avg)

count = df[df['商品类别']=='电子产品']['购买数量'].sum()
print('电子产品的总购买数量:',count)